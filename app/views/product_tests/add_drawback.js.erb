// alert('add_advantage');

var drawback_val = $('input#product_test_drawback').val(),
	drawbacks_val = $('ul#drawbacks_preview').html(),
	last_source = $('ul#drawbacks_preview li:last-child');
	
	
	
	if (last_source.length){
		last_source = parseInt(last_source.attr('class'));
		last_source++;
	} else{
		last_source = "0";
	}
	
	var link_to_remove_drawback = "<%= product_tests_remove_drawback_path %>";
	
	
	if (drawback_val != ""){
		
		if (drawbacks_val != "") {
			// alert("if");
			drawbacks_val = drawbacks_val + "<li class='" + last_source + "'>" + drawback_val + "</a>" + "<a href='" + link_to_remove_drawback + "?source=" + last_source + "' data-remote='true' class='remove_source'>Supprimer</a></li>";
		} else {
			// alert(drawbacks_val);
			drawbacks_val = "<li class='" + last_source + "'>" + drawback_val + "</a>" + "<a href='" + link_to_remove_source + "?source=" + last_source + "' data-remote='true' class='remove_source'>Supprimer</a></li>";
		}
		
		$('ul#drawbacks_preview').html(drawbacks_val);
		$('ul#drawbacks_preview li a.remove_source').remove();
		var drawbacks_val_without_remove_link = $('ul#drawbacks_preview').html();
		$('textarea#product_test_drawbacks').val(drawbacks_val_without_remove_link);
		$('ul#drawbacks_preview').html(drawbacks_val);
	}
	

$('a#add_drawback_button').remove();
$('input#product_test_drawback').remove();

$('div#drawback_buttons').html('<%= escape_javascript(link_to("Ajouter un avantage", product_tests_show_drawback_form_field_path, :remote => true, :id => "show_drawback_form_field_button")) %>');