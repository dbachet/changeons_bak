<%= form_for(@new_comment, :url => {:action => "create", :controller => "comments", :post_id => @post, :anchor => "new_comment"}, :remote => true, :validate => (current_user ? true : false)) do |f| %>
	
	<h1>New comment</h1>

	<% if @new_comment.errors.any? %>
		<div id="error_explanation">
			<h2><%= pluralize(@new_comment.errors.count, "error") %> prohibited this comment from being saved:</h2>
  
			<ul>
			<% @new_comment.errors.full_messages.each do |msg| %>
				<li><%= msg %></li>
			<% end %>
			</ul>
		</div>
	<% end %>

	<%= Devise.mappings.keys %>

	<div class="field">
	  <%= f.label :title %><br />
	  <%= f.text_field :title %>
	</div>
	
	<div class="field">
    	<%= f.label :body %><br />
    	<%= f.text_area :body, :validate => true %>
	</div>

	<div class="new_comment_guest_fields">
  	</div>

	<div class="actions">
	<% if current_user %>
		<%= f.submit %>
	<% else %>
		<div class="wrap_drop_write_as">
		<%= render 'comments/drop_write_as' %>
		</div>
	<% end %>
	</div>
<% end %>
