// Change the custom data value which remembers how many comments are displayed
$('div#display_comments').data('displayed-comments', <%= @displayed_comments %>);

// Change the param displayed_comments in url of link
$('a#show_more_comments_link').attr('href', "/posts/<%= @post.cached_slug %>/show_more_comments?displayed_comments=" + <%= @displayed_comments %>);

// Display the new posts
$('div#display_comments > div:last').after("<%= escape_javascript(render :partial => 'comments/more_comments') %>");

$('div.new').hide();
$('div.new').fadeIn(1500);
$('div.new').removeClass('new');


// CHECK IF THERE ARE MORE COMMENT TO DISPLAY, IF NO, REMOVE THE BUTTON 'MORE COMMENTS'
if (<%= @remaining_comments == 0 %>) {
	$('a#show_more_comments_link').remove();
}